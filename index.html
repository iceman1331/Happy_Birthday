<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <!-- iPhone Optimization -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#0f0f14">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <title>For You ‚ù§Ô∏è</title>

  <link rel="preload" href="I2.png" as="image">
  <link rel="preload" href="I_in_1.jpg" as="image">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="loading.css">
</head>

<body>

<div class="loader-wrapper">
  <canvas id="loader" width="480" height="480">
  </canvas>
  <h1>Preparing something special for you ‚ù§Ô∏è</h1>
</div>

<!-- HEART ANIMATION SCRIPT -->
<script>

  setTimeout(() => {
    document.querySelector("h1").innerText = "Almost ready‚Ä¶ üíï";
  }, 6000);

  document.body.classList.add("glow");

  Loadr = new (function Loadr(id){

    const max_size = 24;
    const max_particles = 2000;
    const min_vel = 20;
    const max_generation_per_frame = 10;

    var canvas = document.getElementById(id);
    var ctx = canvas.getContext('2d');
    var height = canvas.height;
    var center_y = height/2;
    var width = canvas.width;
    var center_x = width/2;
    var particles = [];
    var last = Date.now(), now = 0, dt;

    function isInsideHeart(x,y){
      x = ((x - center_x) / center_x) * 3;
      y = ((y - center_y) / center_y) * -3;
      var x2 = x * x;
      var y2 = y * y;
      return (Math.pow((x2 + y2 - 1), 3) - (x2 * (y2 * y)) < 0);
    }

    function random(size,freq){
      var val = 0;
      var iter = freq;
      do{
        size /= iter;
        iter += freq;
        val += size * Math.random();
      } while(size >= 1);
      return val;
    }

    function Particle(){
      var x = center_x;
      var y = center_y;
      var size = ~~random(max_size,2.4);
      var x_vel = ((max_size + min_vel) - size)/2 - (Math.random() * ((max_size + min_vel) - size));
      var y_vel = ((max_size + min_vel) - size)/2 - (Math.random() * ((max_size + min_vel) - size));
      var nx = x;
      var ny = y;
      var r,g,b,a = 0.05 * size;

      this.draw = function(){
        r = ~~(255 * (x / width));
        g = ~~(255 * (1 - (y / height)));
        b = ~~(255 - r);
        ctx.fillStyle = 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';
        ctx.beginPath();
        ctx.arc(x,y,size,0,Math.PI*2,true);
        ctx.fill();
      }

      this.move = function(dt){
        nx += x_vel * dt;
        ny += y_vel * dt;

        if(!isInsideHeart(nx,ny)){
          if(!isInsideHeart(nx,y)){ x_vel *= -1; return; }
          if(!isInsideHeart(x,ny)){ y_vel *= -1; return; }
          x_vel = -1 * y_vel;
          y_vel = -1 * x_vel;
          return;
        }

        x = nx;
        y = ny;
      }
    }


    function movementTick(){
      var dead = max_particles - particles.length;
      for(var i=0; i<dead && i<max_generation_per_frame; i++){
        particles.push(new Particle());
      }

      now = Date.now();
      dt = (now - last)/750;   /* FIXED (was negative before) */
      last = now;

      particles.forEach(function(p){ p.move(dt); });
    }

    function tick(){
      ctx.clearRect(0,0,width,height);
      particles.forEach(function(p){ p.draw(); });
      requestAnimationFrame(tick);
    }

    // setInterval(movementTick,16);
    // tick();
    function animate(){
      movementTick();
      ctx.clearRect(0,0,width,height);
      particles.forEach(function(p){
        p.move(dt);
        p.draw();
      });
      requestAnimationFrame(animate);
    }

    animate();

  })("loader");
</script>

<!-- REDIRECT AFTER 5 SECONDS -->
<script>
  window.addEventListener("load", function () {
    setTimeout(function () {
      document.body.classList.add("fade-out");
      setTimeout(function () {
        window.location.href = "card_5.html";
      }, 5000);
    }, 5000);
  });
</script>

</body>
</html>
